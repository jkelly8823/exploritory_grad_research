VULNERABLE: YES
VULNERABLE_LINES: 1
VULNERABILITY_DESCRIPTION:
Assignment in conditional statement vulnerability. The code uses the assignment operator (=) in a conditional statement, which can lead to unexpected behavior and potential security vulnerabilities.

EXPLANATION:
The assignment operator (=) is used in the conditional statement of the if statement. This can lead to issues because the assignment is executed before the condition is evaluated. If the assignment fails or returns a falsey value, the condition will not be met, but the assignment will still occur. In this case, the code is assigning the result of SSL_get_peer_certificate to the variable cert, which could be a security risk if not intended.

RECOMMENDATIONS:
To fix this vulnerability, the code should use the comparison operator (==) instead of the assignment operator (=) in the conditional statement. This will ensure that the condition is evaluated correctly and prevent any unexpected behavior. The corrected code should look like this:

if (cert == SSL_get_peer_certificate(ssl))

However, in modern C++ or C, it is recommended to use nullptr checks instead, to avoid accidental assignments:

if ((cert = SSL_get_peer_certificate(ssl)) != nullptr)

The extra parentheses around the assignment ensure that the result of the assignment is not compared in the condition.

ORIGINAL CODE:
if (cert = SSL_get_peer_certificate(ssl)) {
        
                      
                           // got a certificate, do secret things
                           
                        
                     
                  
               
   }