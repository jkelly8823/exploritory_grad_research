VULNERABLE: YES
VULNERABLE_LINES: 10
VULNERABILITY_DESCRIPTION: Logic Error: The assignment statement assigns `rom_rdata_linux` to both `rom_rdata_linux` and  `rom_rdata`.

EXPLANATION:
The line `assign rom_rdata = (ariane_boot_sel_i) ? rom_rdata_linux : rom_rdata_linux;`  is incorrectly assigning the value of `rom_rdata_linux` to itself regardless of the value of `ariane_boot_sel_i`. This will always result in `rom_rdata` having the same value as `rom_rdata_linux`.  The ternary operator seems to be incorrectly used.

RECOMMENDATIONS:
To fix this vulnerability, ensure that the appropriate value (either `rom_rdata_linux` or `rom_rdata_patch`) is assigned to `rom_rdata` based on the value of `ariane_boot_sel_i`.

UPDATE THE CODE AS FOLLOWING:

```
assign rom_rdata = (ariane_boot_sel_i) ? rom_rdata_linux : rom_rdata_patch;
```



 

ORIGINAL CODE:

```
...
bootrom i_bootrom_patch (
							
							.clk_i                   ,
							.req_i      ( rom_req   ),
							.addr_i     ( rom_addr  ),
							.rdata_o    ( rom_rdata_patch )
							
						);
bootrom_linux i_bootrom_linux (
							
							.clk_i                   ,
							.req_i      ( rom_req   ),
							.addr_i     ( rom_addr  ),
							.rdata_o    ( rom_rdata_linux )
							
						);
						
assign rom_rdata = (ariane_boot_sel_i) ? rom_rdata_linux : rom_rdata_linux;
......
``` 
