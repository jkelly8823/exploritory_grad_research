VULNERABLE: YES
VULNERABLE_LINES: 1
VULNERABILITY_DESCRIPTION:  Potential for a Denial of Service (DoS) vulnerability due to incorrect comparison operator. 
EXPLANATION:
The code snippet checks if a certificate is obtained using `cert = SSL_get_peer_certificate(ssl)`.  The problem is the use of the assignment operator `=` instead of the comparison operator `==`. This means the code will always assign the result of `SSL_get_peer_certificate(ssl)` to the variable `cert`, regardless of whether a certificate was actually retrieved. If `SSL_get_peer_certificate(ssl)` returns NULL, the assignment will still succeed, leading to a potential bypass of the intended certificate check.

RECOMMENDATIONS:
Change the line `if (cert = SSL_get_peer_certificate(ssl))` to `if (cert == SSL_get_peer_certificate(ssl))`. This correction will properly compare for equality and ensure that the code only executes if a valid certificate was successfully obtained.


ORIGINAL CODE: 
                  if (cert = SSL_get_peer_certificate(ssl)) {
                        
                           
                           // got certificate, host can be trusted
                           
                           
                           //foo=SSL_get_verify_result(ssl);
                           
                           
                           //if (X509_V_OK==foo) ...
                           
                        
                     } 
               







