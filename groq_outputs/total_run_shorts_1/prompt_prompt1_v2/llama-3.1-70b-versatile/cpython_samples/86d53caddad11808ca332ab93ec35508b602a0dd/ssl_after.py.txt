VULNERABLE: NO
VULNERABLE_LINES: None
VULNERABILITY_DESCRIPTION:
None
EXPLANATION:
This code appears to be a function that converts a DNS name to a pattern. It checks for the presence of wildcards in the DNS name and ensures that there is only one wildcard per fragment. This is a reasonable security measure to prevent potential denial-of-service attacks or unintended behavior. The function also correctly handles the case where '*' is a single fragment.

After reviewing the code, no security vulnerabilities were found. The function's checks and error handling are appropriate and in line with secure coding practices.

RECOMMENDATIONS:
None

ORIGINAL CODE:
```python
    pass


def _dnsname_to_pat(dn, max_wildcards=1):
    pats = []
    for frag in dn.split(r'.'):
        if frag.count('*') > max_wildcards:
            # Issue #17980: avoid denials of service by refusing more
            # than one wildcard per fragment.  A survery of established
            # policy among SSL implementations showed it to be a
            # reasonable choice.
            raise CertificateError(
                "too many wildcards in certificate DNS name: " + repr(dn))
        if frag == '*':
            # When '*' is a fragment by itself, it matches a non-empty dotless
            # fragment.
            pats.append('[^.]+')
```