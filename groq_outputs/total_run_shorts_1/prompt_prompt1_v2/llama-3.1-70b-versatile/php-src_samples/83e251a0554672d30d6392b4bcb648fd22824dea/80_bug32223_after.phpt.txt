VULNERABLE: YES
VULNERABLE_LINES: 3
VULNERABILITY_DESCRIPTION:
The code contains an uncontrolled error condition that may lead to an information disclosure vulnerability. Specifically, the code does not handle the error condition properly and dies with a user-friendly error message that may reveal valuable information to an attacker.

EXPLANATION:
The code checks if the execute command for creating a function in PL/pgSQL language was successful and exits the script if it was not. While it might be intended to create an error, it might disclose whether PLPGSQL is available or not.

RECOMMENDATIONS:
Instead of dying with a user-friendly message that may reveal sensitive information, it's recommended to:

- Log the error message instead of displaying it to the user.
- Provide a generic error message to the user that does not reveal any sensitive information.
- Ensure that the script continues running even after the error, or properly handle the error so that it does not cause a crash.

ORIGINAL CODE:

' LANGUAGE plpgsql;");
if (!$res) die('skip PLPGSQL not available');
?>
--INI--
pgsql.ignore_notice=0
--FILE--
<?php

require_once('config.inc');