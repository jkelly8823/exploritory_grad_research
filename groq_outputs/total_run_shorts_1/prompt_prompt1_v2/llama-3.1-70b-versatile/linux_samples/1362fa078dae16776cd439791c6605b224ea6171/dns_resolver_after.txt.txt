VULNERABLE: YES
VULNERABLE_LINES: 1
VULNERABILITY_DESCRIPTION:
The given code allows any user to read and potentially exploit sensitive DNS resolver data.

EXPLANATION:
The code grants read access to the dns_resolver keys using 'keyctl read' with a wildcard "* *". This allows any user to read sensitive DNS resolver configuration data. This can be a security risk if the DNS resolver contains sensitive information.

RECOMMENDATIONS:
Restrict the access control to specific users or groups, instead of allowing all users to read the dns_resolver keys. The line should be modified to:
create dns_resolver foo:owner owner *(A)
This only allows the owner to read and use the dns_resolver.

Additionally, consider introducing more restrictive permissions for keys that contain sensitive data. Usage of wildcards should be restricted and least privilege principle should be followed.

ORIGINAL CODE:

create dns_resolver  	foo:*	*	/usr/sbin/dns.foo %k


=====
USAGE
=====

 returned also.


===============================
READING DNS KEYS FROM USERSPACE
===============================

Keys of dns_resolver type can be read from userspace using keyctl_read() or
"keyctl read/print/pipe".


=========
MECHANISM
=========