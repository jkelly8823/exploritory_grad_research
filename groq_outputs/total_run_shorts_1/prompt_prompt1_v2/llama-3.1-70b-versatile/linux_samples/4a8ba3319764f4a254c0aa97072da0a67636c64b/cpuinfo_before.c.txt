VULNERABLE: YES
VULNERABLE_LINES: 5
VULNERABILITY_DESCRIPTION:
The provided code snippet contains an information disclosure vulnerability in case of an error. The error message includes a potentially sensitive keyword ("DIV") that can be used to infer information about the system's configuration.

EXPLANATION:
The code snippet uses the macro `err_cpu` to print an error message when the system is configured to enable hardware division support (`CONFIG_NIOS2_HW_DIV_SUPPORT` is enabled) but the CPU does not support division (`cpuinfo.has_div` is false). However, this error message includes the string "DIV", which could potentially reveal sensitive information about the system's capabilities to an attacker.

RECOMMENDATIONS:
To fix this vulnerability, it is recommended to modify the error message to avoid revealing sensitive information. Instead of including the string "DIV" in the error message, consider using a more generic error message that does not reveal any sensitive information. For example:

```c
if (IS_ENABLED(CONFIG_NIOS2_HW_DIV_SUPPORT) && !cpuinfo.has_div)
    err_cpu("division support not available");
```

ORIGINAL CODE:

.cpuinfo.has_div = fcpu_has(cpu, "altr,has-div");
cpuinfo.has_mul = fcpu_has(cpu, "altr,has-mul");
cpuinfo.has_mulx = fcpu_has(cpu, "altr,has-mulx");

if (IS_ENABLED(CONFIG_NIOS2_HW_DIV_SUPPORT) && !cpuinfo.has_div)
    err_cpu("DIV");