VULNERABLE: YES
VULNERABLE_LINES: 4-6, 9, 11-12
VULNERABILITY_DESCRIPTION:
Duplicate logic and variable declaration
EXPLANATION:
The provided code snippet contains duplicate logic for mapping `info->page_size` to `page_size`. The same `if` statement is repeated twice in the snippet, and the variable `page_size` is declared twice. This duplication can lead to inconsistent behavior if the logic is updated in one place but not the other. Additionally, the duplicate variable declaration can cause compilation errors.

Furthermore, the code does not handle cases where `info->page_size` does not match the specified values. This can lead to unpredictable behavior or incorrect configuration.

RECOMMENDATIONS:
1. Remove the duplicate logic and variable declaration to ensure consistency and avoid potential errors.
2. Add a default case or error handling to handle `info->page_size` values that do not match the specified values.
3. Consider using a switch statement or a lookup table to improve code readability and maintainability.

ORIGINAL CODE:

	u64 hdr;
	enum irdma_page_size page_size;

	if (!info->total_len && !info->all_memory)
		return -EINVAL;

	if (info->page_size == 0x40000000)
		page_size = IRDMA_PAGE_SIZE_1G;
	else if (info->page_size == 0x200000)
		page_size = IRDMA_PAGE_SIZE_2M;
	u8 addr_type;
	enum irdma_page_size page_size;

	if (!info->total_len && !info->all_memory)
		return -EINVAL;

	if (info->page_size == 0x40000000)
		page_size = IRDMA_PAGE_SIZE_1G;
	else if (info->page_size == 0x200000)
		page_size = IRDMA_PAGE_SIZE_2M;