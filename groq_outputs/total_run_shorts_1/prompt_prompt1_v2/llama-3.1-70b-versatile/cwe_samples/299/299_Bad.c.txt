VULNERABLE: YES
VULNERABLE_LINES: 1
VULNERABILITY_DESCRIPTION:
The code contains a vulnerability due to an assignment in a conditional statement, which may lead to unintended behavior.

EXPLANATION:
In C and C-derived languages, the single equals sign (=) is used for assignment operations, while the double equals sign (==) is used for equality comparisons. However, in C, assignment operations evaluate to the assigned value and can be used in conditional statements. This can sometimes lead to bugs, as the difference between assignment and comparison can be hard to spot. In this code, the assignment 'cert = SSL_get_peer_certificate(ssl)' may not be the intended behavior for the conditional, potentially leading to issues.

RECOMMENDATIONS:
It is recommended to change the assignment to a comparison using the triple equals sign (cert == SSL_get_peer_certificate(ssl) or cert != NULL) to ensure the correct behavior for the conditional statement. This will help to prevent potential bugs.

ORIGINAL CODE:
if (cert = SSL_get_peer_certificate(ssl)) {
    // got a certificate, do secret things
}