VULNERABLE: YES
VULNERABLE_LINES: 1
VULNERABILITY_DESCRIPTION:
Assignment in a Conditional Statement

EXPLANATION:
In the provided code snippet, there is an assignment statement in the condition of an if statement. This can be a potential vulnerability as it may lead to unintended behavior. In this case, the code assigns the return value of `SSL_get_peer_certificate(ssl)` to the `cert` variable and then checks if the result is truthy. This can be confusing because it does both an assignment and a conditional check in a single line. However, the main concern here is potential for an L-value required error or unexpected behavior due to the assignment if not properly understood.

RECOMMENDATIONS:
It's good practice to avoid assigning values in conditional statements to avoid confusion. Instead, consider breaking the assignment and the condition into two separate lines.

```
cert = SSL_get_peer_certificate(ssl);
if (cert) {
    // rest of the code here
}
```

This makes the code clearer and easier to understand.

ORIGINAL CODE:
```
if (cert = SSL_get_peer_certificate(ssl)) {
     
                           
                           // got certificate, host can be trusted
                           
                           
                           //foo=SSL_get_verify_result(ssl);
                           
                           
                           //if (X509_V_OK==foo) ...
                           
                        
                     }
```