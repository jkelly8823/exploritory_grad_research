 

VULNERABLE: YES
VULNERABLE_LINES: 9
EXPLANATION:
The decode_credentials method in the provided code is vulnerable to a denial of service attack. This is because it converts Digest Authentication strings to symbols, which can be exploited by an attacker to cause a denial of service. This vulnerability is present in the line where the key is converted to a symbol using the to_sym method.
RECOMMENDATIONS:
To fix this vulnerability, the code should be modified to handle the Digest Authentication strings without converting them to symbols. This can be achieved by removing the to_sym method call when converting the key. The modified code should look like this:
```ruby
def decode_credentials(header)
  Hash[header.to_s.gsub(/^Digest\s+/,'').split(',').map do |pair|
    key, value = pair.split('=', 2)
    [key.strip, value.to_s.gsub(/^"|"$/,'').delete('\'')]
  end]
end
```VULNERABILITY LIST:
CVE_ID:CVE-2012-3424
CVE Description:
The decode_credentials method in actionpack/lib/action_controller/metal/http_authentication.rb in Ruby on Rails 3.x before 3.0.16, 3.1.x