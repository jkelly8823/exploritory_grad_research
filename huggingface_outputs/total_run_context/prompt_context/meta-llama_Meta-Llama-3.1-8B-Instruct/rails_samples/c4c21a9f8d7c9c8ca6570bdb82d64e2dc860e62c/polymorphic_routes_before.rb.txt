 

VULNERABLE: YES
VULNERABLE_LINES: 9
EXPLANATION:
The code is vulnerable to the CVE-2021-22885 vulnerability because it uses the `redirect_to` helper with untrusted user input. The `record_list.map` block is iterating over a list of objects, and the `case` statement is used to determine the type of object. However, the `args` array is being populated with untrusted user input, which can lead to an information disclosure or unintended method execution vulnerability.
RECOMMENDATIONS:
1. Validate and sanitize the user input before passing it to the `redirect_to` helper.
2. Use a secure method to generate the route, such as using a parameterized route or a secure route generation library.
3. Consider using a more secure approach, such as using a template engine to generate the route, rather than relying on the `redirect_to` helper. 

VULNERABILITY LIST: 
CVE_ID:CVE-2021-22885
CVE Description:
A possible information disclosure / unintended method execution vulnerability in Action Pack >= 2.0.0 when using the `redirect_to` or `polymorphic_url`helper with untrusted user input.  CVE_ID:CVE