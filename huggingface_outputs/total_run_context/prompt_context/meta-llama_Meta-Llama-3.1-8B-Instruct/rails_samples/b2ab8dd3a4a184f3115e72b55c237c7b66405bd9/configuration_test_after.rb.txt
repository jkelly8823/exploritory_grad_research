 

VULNERABLE: YES
VULNERABLE_LINES: 14
EXPLANATION:
The code is vulnerable to code injection due to the ActiveStorage variant processor being set to :vips. This allows an attacker to execute code via image_processing arguments. The code is using the vips variant processor which is known to be vulnerable to code injection.
RECOMMENDATIONS:
1. Update ActiveStorage to a version that is not vulnerable to code injection.
2. Set the ActiveStorage variant processor to a secure variant processor such as :mini_magick.
3. Configure the ActiveStorage supported image processing methods to only include secure methods.
4. Configure the ActiveStorage unsupported image processing arguments to include any arguments that could be used for code injection.  ```ruby
ActiveStorage.variant_processor = :mini_magick
ActiveStorage.supported_image_processing_methods = ["resize", "crop"]
ActiveStorage.unsupported_image_processing_arguments = %w(
  -write
  -danger
)
``` ```ruby
```VULNERABILITY LIST:
CVE_ID:CVE-2022-21831
CVE Description:
A code injection vulnerability exists in the Active Storage >= v5.2.0 that could allow an attacker to execute code via image_processing arguments.``` ```