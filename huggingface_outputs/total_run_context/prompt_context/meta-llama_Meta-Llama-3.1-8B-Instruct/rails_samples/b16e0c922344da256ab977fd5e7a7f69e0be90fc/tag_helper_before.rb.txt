 

VULNERABLE: YES
VULNERABLE_LINES: 6
EXPLANATION:
The code is vulnerable to cross-site scripting (XSS) due to the use of the `gsub` method with a regular expression that does not properly handle Unicode characters. The regular expression `/[\"><]|&(?!([a-zA-Z]+|(#\d+));)/` is intended to match HTML tags and entities, but it can be bypassed by injecting Unicode characters that are not properly escaped. This allows an attacker to inject malicious script or HTML into the application.
RECOMMENDATIONS:
To fix this vulnerability, the regular expression should be updated to properly handle Unicode characters. One possible solution is to use the `CGI.escapeHTML` method, which is designed to escape HTML characters in a way that is safe from Unicode attacks. The updated code would look like this:
```ruby
def escape_once(html)
  CGI.escapeHTML(html.to_s)
end
``` VULNERABILITY LIST: ```ruby
``` VULNERABILITY LIST: ```ruby
``` VULNERABILITY LIST: ```ruby
``` VULNERABILITY LIST: ```ruby
``` VULNERABILITY LIST: ```ruby
``` VULNERABILITY LIST: ```ruby
