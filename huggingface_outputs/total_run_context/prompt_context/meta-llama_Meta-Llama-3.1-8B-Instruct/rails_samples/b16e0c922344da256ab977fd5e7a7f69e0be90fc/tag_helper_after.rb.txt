 

VULNERABLE: YES
VULNERABLE_LINES: 5
EXPLANATION:
The code is vulnerable to cross-site scripting (XSS) due to the use of the `gsub` method with a regular expression that does not properly handle Unicode characters. This allows an attacker to inject malicious script or HTML by placing malformed Unicode strings into a form helper.
RECOMMENDATIONS:
1. Update the `escape_once` method to use a more robust Unicode handling mechanism, such as the `CGI.escapeHTML` method.
2. Consider using a more modern and secure method for escaping HTML, such as the `ERB::Util.html_escape` method.
3. Review the code to ensure that all instances of the `escape_once` method are properly updated to use the new Unicode handling mechanism.  ```ruby
def escape_once(html)
  CGI.escapeHTML(html.to_s)
end
```  ```ruby
```  ```ruby
```  ```ruby
```  ```ruby
```  ```ruby
```  ```ruby
```  ```ruby
```  ```ruby
```  ```ruby
```  ```ruby
```  ```ruby
```  ```ruby
```  ```ruby
```  ```ruby
```  ```