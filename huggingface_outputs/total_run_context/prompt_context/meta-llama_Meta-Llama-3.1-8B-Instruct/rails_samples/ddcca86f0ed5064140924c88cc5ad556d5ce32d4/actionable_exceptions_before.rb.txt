 

VULNERABLE: YES
VULNERABLE_LINES: 12
EXPLANATION:
The code is vulnerable to a possible XSS vulnerability due to the use of ERB::Util.unwrapped_html_escape(location) in the redirect_to method. This method does not properly escape the location parameter, allowing an attacker to inject malicious HTML code. This is particularly concerning when the application is running in development mode, as mentioned in the CVE description.
RECOMMENDATIONS:
- Use the `CGI.escapeHTML` method to properly escape the location parameter.
- Consider using a more secure method to generate the redirect HTML, such as using a template engine like ERb or Haml.
- Ensure that the application is running in production mode when possible, as this vulnerability is mitigated in production mode.  ```ruby
def redirect_to(location)
  body = "<html><body>You are being <a href=\"#{CGI.escapeHTML(location)}\">redirected</a>.</body></html>"
  #...
end
``` VULNERABILITY LIST: ```ruby
CVE_ID:CVE-2020-8264
CVE Description:
In actionpack gem >= 6.0.0, a possible XSS vulnerability exists when an application is running in development mode allowing