 

VULNERABLE: NO
VULNERABLE_LINES: None
EXPLANATION:
The code sample provided does not contain any code that would allow a remote attacker to bypass open_basedir restrictions via vectors related to the length of a filename. The code checks if the resolved name starts with the resolved basedir, and if not, it checks if the resolved basedir is a subdirectory of the resolved name. This is a valid check to prevent directory traversal attacks.
RECOMMENDATIONS:
None. The code is secure against the described vulnerability. 

VULNERABILITY LIST: 
CVE_ID:CVE-2010-3436
CVE Description:
fopen_wrappers.c in PHP 5.3.x through 5.3.3 might allow remote attackers to bypass open_basedir restrictions via vectors related to the length of a filename.  The code sample provided does not contain any code that would allow a remote attacker to bypass open_basedir restrictions via vectors related to the length of a filename.  The code checks if the resolved name starts with the resolved basedir, and if not, it checks if the resolved basedir is a subdirectory of the resolved name. This is a valid check to prevent directory traversal attacks.  The vulnerability is not