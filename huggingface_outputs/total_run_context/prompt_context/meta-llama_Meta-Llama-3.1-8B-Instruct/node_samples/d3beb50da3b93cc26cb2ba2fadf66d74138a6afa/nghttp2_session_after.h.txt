 

VULNERABLE: YES
VULNERABLE_LINES: 1
EXPLANATION:
The code is vulnerable to the CVE-2020-11080 vulnerability because it does not implement the nghttp2_on_frame_recv_callback callback to drop the connection when a large SETTINGS frame is received. This allows a malicious client to cause a denial of service by sending an overly large SETTINGS frame.
RECOMMENDATIONS:
Implement the nghttp2_on_frame_recv_callback callback to drop the connection when a large SETTINGS frame is received. This can be done by checking the number of settings entries in the received SETTINGS frame and dropping the connection if it exceeds a certain threshold (e.g., > 32). Additionally, consider implementing a workaround by limiting the maximum length of the SETTINGS frame payload. 

VULNERABILITY LIST: 
CVE_ID:CVE-2020-11080
CVE Description:
In nghttp2 before version 1.41.0, the overly large HTTP/2 SETTINGS frame payload causes denial of service. The proof of concept attack involves a malicious client constructing a SETTINGS frame with a length of 14,400 bytes (2400 individual settings entries) over and over again. The attack causes the CPU to spike at 100%. nghttp2 v