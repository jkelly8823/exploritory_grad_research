 
VULNERABLE: YES
VULNERABLE_LINES: 5
EXPLANATION:
The code is vulnerable to the CVE-2019-9510 vulnerability, which is a variant of the CVE-2019-9510 vulnerability. The code is using the GRABSETTING macro to extract settings from the buffer, but it does not check the number of settings entries. This allows an attacker to send a large SETTINGS frame payload, causing a denial of service.
RECOMMENDATIONS:
Implement the nghttp2_on_frame_recv_callback callback to drop the connection if a large SETTINGS frame is received. Alternatively, update the GRABSETTING macro to check the number of settings entries and limit the number of entries to a safe value. 

VULNERABILITY LIST:
CVE_ID:CVE-2019-9510
CVE Description:
In nghttp2 before version 1.41.0, the overly large HTTP/2 SETTINGS frame payload causes denial of service. The proof of concept attack involves a malicious client constructing a SETTINGS frame with a length of 14,400 bytes (2400 individual settings entries) over and over again. The attack causes the CPU to spike at 100%. nghttp2 v1.41.0 fixes this vulnerability. There