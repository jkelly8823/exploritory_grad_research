 

VULNERABLE: YES
VULNERABLE_LINES: 1
EXPLANATION:
The code sample provided is vulnerable to a buffer overrun in X.509 certificate verification, specifically in name constraint checking. This is due to the use of BN_is_prime_ex() and BN_is_prime_fasttest_ex() functions which can be triggered by a malicious certificate. An attacker can craft a malicious email address in a certificate to overflow an arbitrary number of bytes containing the `.' character (decimal 46) on the stack. This buffer overflow could result in a crash (causing a denial of service).
RECOMMENDATIONS:
- Use L<BN_check_prime(3)> which avoids possible misuse and always uses at least 64 rounds of the Miller-Rabin primality test.
- Upgrade to a new version of OpenSSL as soon as possible to fix the vulnerability. 

VULNERABILITY LIST:
CVE_ID:CVE-2022-3602
CVE_ID:CVE-2022-3786
```


VULNERABLE: YES
VULNERABLE_LINES: 1
EXPLANATION:
The code sample provided is vulnerable to a buffer overrun in X.509 certificate verification, specifically in name constraint checking. This is due to the use of