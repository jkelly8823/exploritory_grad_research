 

VULNERABLE: YES
VULNERABLE_LINES: 14, 20
EXPLANATION:
The code is vulnerable to CVE-2021-22939. The rejectUnauthorized property is not being checked correctly. In the lines 14 and 20, the code is checking if rejectUnauthorized is not equal to false, but it should be checking if it is not equal to undefined. This is because if rejectUnauthorized is explicitly defined as undefined, the default value of true will be assigned to it, and the connection will be accepted even if the server's certificate is expired.
RECOMMENDATIONS:
- Change the condition in lines 14 and 20 to check if rejectUnauthorized is not equal to undefined.
- Add a check to ensure that rejectUnauthorized is not equal to undefined before assigning it to tlssock connection options. 

VULNERABILITY LIST: 
CVE_ID:CVE-2021-22939
CVE Description:
If the Node.js https API was used incorrectly and "undefined" was in passed for the "rejectUnauthorized" parameter, no error was returned and connections to servers with an expired certificate would have been accepted. 
CVE_ID:CVE-2021-22939
CVE Description:
If the Node.js https API was used