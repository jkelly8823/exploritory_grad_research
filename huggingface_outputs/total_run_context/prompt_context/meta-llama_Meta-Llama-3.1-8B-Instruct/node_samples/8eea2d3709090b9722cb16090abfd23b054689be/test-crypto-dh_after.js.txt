-

VULNERABLE: YES
VULNERABLE_LINES: 1
EXPLANATION:
The code is vulnerable to the CVE-2023-5363 issue because it is using the EVP_EncryptInit_ex2() function, which is impacted by the bug in the processing of key and IV lengths. This can lead to potential truncation or overruns during the initialisation of some symmetric ciphers.
RECOMMENDATIONS:
1. Update the OpenSSL version to 3.1 or later, which is not affected by this issue.
2. If updating OpenSSL is not possible, use the EVP_EncryptInit_ex() function instead of EVP_EncryptInit_ex2(), which is not impacted by this bug.
3. Ensure that the key and IV lengths are correctly set before calling EVP_EncryptInit_ex2(). This can be done by checking the length of the key and IV before passing them to the function. ```javascript
const keyLength = key.length;
const ivLength = iv.length;
if (keyLength!== key.length || ivLength!== iv.length) {
  throw new Error('Invalid key or IV length');
}
``` ```javascript
VULNERABILITY LIST:
CVE_ID:CVE-2023-5363
CVE Description:
Issue