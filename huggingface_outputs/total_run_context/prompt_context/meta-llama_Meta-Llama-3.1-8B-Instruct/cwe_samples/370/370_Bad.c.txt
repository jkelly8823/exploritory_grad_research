 

VULNERABLE: YES
VULNERABLE_LINES: 7-8
EXPLANATION:
The code does not check the revocation status of the certificate after the initial revocation check. This can cause the product to perform privileged actions even after the certificate is revoked at a later time. The second call to SSL_get_verify_result(ssl) is not necessary and can be removed.
RECOMMENDATIONS:
Remove the second call to SSL_get_verify_result(ssl) to ensure the revocation status of the certificate is checked after the initial revocation check. This can be done by removing the line "foo=SSL_get_verify_result(ssl);" on line 8. 

VULNERABILITY LIST:
CWE_ID: 119
CWE Description:
The code does not check for a null pointer before dereferencing it, which can cause a null pointer dereference.

Code Sample:

                  if (cert = SSL_get_peer_certificate(ssl)) {
                        foo=SSL_get_verify_result(ssl);if (X509_V_OK==foo)
                              
                                 
                                 //do stuff
                                 
                              
                           
                        
                     
                  
               
               

This concludes your task. Provide your response here: 

VULNERABLE: NO
VULNERABLE