 

VULNERABLE: YES
VULNERABLE_LINES: 2
EXPLANATION:
The code is vulnerable to SQL injection attacks. The value of the cookie "mid" is directly inserted into the SQL query without any sanitization or validation. This allows an attacker to inject malicious SQL code by manipulating the value of the cookie. For example, an attacker could set the cookie to "1 OR 1=1" to retrieve all messages.
RECOMMENDATIONS:
Use prepared statements or parameterized queries to prevent SQL injection attacks. In this case, you can use the following code: $id = $_COOKIE["mid"]; $stmt = $mysqli->prepare("SELECT MessageID, Subject FROM messages WHERE MessageID =?"); $stmt->bind_param("i", $id); $stmt->execute(); $result = $stmt->get_result(); while($row = $result->fetch_assoc()) { // process the result } $stmt->close(); 

VULNERABILITY LIST: 
CWE_ID: 89
CWE Description:
The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when