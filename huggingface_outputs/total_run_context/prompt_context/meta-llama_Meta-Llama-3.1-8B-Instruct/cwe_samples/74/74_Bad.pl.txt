 

VULNERABLE: YES
VULNERABLE_LINES: 11-12
EXPLANATION:
The code is vulnerable to CWE-74 because it constructs a command using externally-influenced input from the user without properly sanitizing it. The `do_listing` subroutine builds a command string using the user-provided filename, which can lead to command injection attacks if the filename contains special characters. Although the `validate_name` subroutine attempts to validate the filename, it only checks for alphanumeric characters and hyphens, which is not sufficient to prevent command injection.
RECOMMENDATIONS:
1. Use a whitelist approach to validate the filename, allowing only specific, known-safe characters.
2. Use a parameterized query or a library that properly escapes user input to prevent command injection.
3. Consider using a safer alternative to `system()` to execute the command, such as a library that provides a secure way to execute commands.