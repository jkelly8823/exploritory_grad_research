 

VULNERABLE: YES
VULNERABLE_LINES: 14-16
EXPLANATION:
The code is vulnerable to the offset2lib patch vulnerability as described in CVE-2017-1000370. The code is using the MAP_FIXED flag when loading ET_DYN binaries, which allows a PIE binary to be execve()'ed with 1GB of arguments or environmental strings. This is a different issue than CVE-2017-1000371.
RECOMMENDATIONS:
To fix this vulnerability, the code should not use the MAP_FIXED flag when loading ET_DYN binaries. Instead, it should use the MAP_PRIVATE flag to load the binary into a private mapping. This will prevent the binary from being loaded at a fixed address, which is necessary to prevent the offset2lib patch vulnerability. Additionally, the code should check the RLIMIT_STACK limit to ensure that the stack is not grown down to 0x80000000. This will prevent the stack guard page from being jumped over by an attacker. 

VULNERABILITY LIST:
CVE_ID:CVE-2017-1000370
CVE Description:
The offset2lib patch as used in the Linux Kernel contains a vulnerability that allows a PIE binary to be execve()'ed