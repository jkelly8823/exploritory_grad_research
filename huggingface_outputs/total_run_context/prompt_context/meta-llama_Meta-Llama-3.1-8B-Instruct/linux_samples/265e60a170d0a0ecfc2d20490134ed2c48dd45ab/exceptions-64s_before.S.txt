 

VULNERABLE: YES
VULNERABLE_LINES: 5
EXPLANATION:
The code is vulnerable to CVE-2017-1000255 because it uses the TRAMP_KVM macro which is a part of the PowerPC transactional memory (TM) feature. This feature allows a user process to craft a signal frame and then do a sigreturn so that the kernel will take an exception (interrupt), and use the r1 value *from the signal frame* as the kernel stack pointer. This allows an attacker to overwrite arbitrary locations with arbitrary values.
RECOMMENDATIONS:
1. Disable the PowerPC transactional memory (TM) feature by setting CONFIG_PPC_TRANSACTIONAL_MEM=n in the kernel configuration.
2. Use a secure exception handling mechanism that does not rely on the signal frame.
3. Validate the signal frame before using it to prevent an attacker from overwriting arbitrary locations with arbitrary values. 

VULNERABILITY LIST: 
CVE_ID:CVE-2017-1000255
CVE Description:
On Linux running on PowerPC hardware (PowerPC or later) a user process can craft a signal frame and then do a sigreturn so that the kernel will take an exception (interrupt), and use the r1 value *