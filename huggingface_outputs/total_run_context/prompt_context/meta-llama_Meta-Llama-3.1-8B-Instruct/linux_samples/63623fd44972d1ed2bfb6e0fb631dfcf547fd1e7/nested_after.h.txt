 

VULNERABLE: YES
VULNERABLE_LINES: 10
EXPLANATION:
The code is vulnerable to the CVE-2020-2732 vulnerability because it does not properly handle the instruction emulation for an L2 guest when nested virtualisation is enabled. The function get_vmcs12() does not check if the PIN_BASED_VIRTUAL_NMIS flag is set before accessing the pin_based_vm_exec_control field of the vmcs12 structure. This can lead to accessing sensitive L1 resources that should be inaccessible to the L2 guest.
RECOMMENDATIONS:
1. Add a check to ensure that the PIN_BASED_VIRTUAL_NMIS flag is set before accessing the pin_based_vm_exec_control field of the vmcs12 structure.
2. Use a safer approach to access the pin_based_vm_exec_control field, such as using a pointer to the field instead of accessing it directly.
3. Consider using a more secure method to handle instruction emulation for an L2 guest when nested virtualisation is enabled. 

VULNERABILITY LIST:
CVE_ID:CVE-2020-2732
CVE Description:
A flaw was discovered in the way that the KVM hypervisor handled instruction emulation for an L2 guest when nested virtualisation is enabled. Under some