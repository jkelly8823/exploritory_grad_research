-

VULNERABLE: YES
VULNERABLE_LINES: 1
EXPLANATION:
The code is vulnerable to a flaw in the way that the KVM hypervisor handles instruction emulation for an L2 guest when nested virtualisation is enabled. This is due to the lack of proper validation of the L2 guest's access to sensitive L1 resources.
RECOMMENDATIONS:
1. Implement proper validation of the L2 guest's access to sensitive L1 resources.
2. Use a secure method to allocate memory for the svm_cpu_data structure.
3. Use a secure method to allocate memory for the sev_vmcbs array.
4. Use a secure method to free the svm_cpu_data structure.
5. Use a secure method to free the sev_vmcbs array. VULNERABILITY LIST:
CVE_ID:CVE-2020-2732
CVE Description:
A flaw was discovered in the way that the KVM hypervisor handled instruction emulation for an L2 guest when nested virtualisation is enabled. Under some circumstances, an L2 guest may trick the L0 guest into accessing sensitive L1 resources that should be inaccessible to the L2 guest. VULNERABLE: YES
VULNERABLE_LINES: 1
EXPLANATION