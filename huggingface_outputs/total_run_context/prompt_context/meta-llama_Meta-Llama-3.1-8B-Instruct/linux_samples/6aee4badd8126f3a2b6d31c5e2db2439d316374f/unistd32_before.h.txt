 

VULNERABLE: YES
VULNERABLE_LINES: 1
EXPLANATION:
The code sample provided is vulnerable to a symlink-exchange attack with Directory Traversal, giving attackers arbitrary read-write access to the host filesystem with root privileges.
RECOMMENDATIONS:
The code sample should be modified to prevent the symlink-exchange attack by ensuring that the daemon/archive.go does not do archive operations on a frozen filesystem (or from within a chroot). This can be achieved by adding a check to ensure that the filesystem is not frozen before performing the archive operation. Additionally, the code should be modified to prevent the execution of arbitrary commands as root within a container. This can be achieved by implementing a whitelist of allowed commands and checking against this whitelist before executing a command. 

VULNERABILITY LIST:
CVE_ID:CVE-2018-15664
CVE_ID:CVE-2019-5736
CVE_ID:CVE-2017-1002101
CVE_ID:CVE-2017-1002102
CVE_ID:CVE-2018-15664
CVE_ID:CVE-2019-5736
CVE_ID:CVE-2017-1002101
CVE_ID:CVE-2017-1002102
