 

VULNERABLE: YES
VULNERABLE_LINES: 1-5, 11-15, 21-25, 31-35, 41-45, 51-55, 61-65, 71-75, 81-85, 91-95
EXPLANATION:
The code is vulnerable to CVE-2022-23036, CVE-2022-23037, CVE-2022-23038, CVE-2022-23039, CVE-2022-23040, CVE-2022-23041, CVE-2022-23042. The vulnerabilities are related to the grant table interfaces for removing access rights of the backends in ways being subject to race conditions, resulting in potential data leaks, data corruption by malicious backends, and denial of service triggered by malicious backends. The code does not properly synchronize the freeing of the related data page with dropping the granted access, allowing the backend to keep access to the memory page even after it has been freed and then re-used for a different purpose.
RECOMMENDATIONS:
1. Synchronize the freeing of the related data page with dropping the granted access.
2. Use a lock to protect the grant table interfaces.
3