 

VULNERABLE: YES
VULNERABLE_LINES: 3
EXPLANATION:
The code sample is vulnerable to CVE-2014-8480. The instruction decoder in the code lacks intended decoder-table flags for the RIP-relative instruction "lsl". This allows a guest OS user to cause a denial of service (NULL pointer dereference and host OS crash) via a crafted application.
RECOMMENDATIONS:
1. Update the instruction decoder to include the intended decoder-table flags for the "lsl" instruction.
2. Use a more secure method to load per CPU data, such as RDTSCP. 
3. Implement additional checks to prevent NULL pointer dereferences.  This may include checking the return value of the "lsl" instruction and handling any errors that may occur.  This will help prevent a denial of service attack.  This may also include adding a check to ensure that the "p" variable is not NULL before attempting to use it.  This will help prevent a segmentation fault.  This may also include adding a check to ensure that the "p" variable is not NULL before attempting to use it.  This will help prevent a segmentation fault.  This may also include adding a check to ensure that the "p