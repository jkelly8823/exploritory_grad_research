 

VULNERABLE: YES
VULNERABLE_LINES: 1
EXPLANATION:
The code is vulnerable to a denial of service (host OS crash) due to the lack of proper validation of the kvm_irq_delivery_to_apic return value in the rtc_irq_check_coalesced function. This allows a guest OS user to cause a denial of service (host OS crash) via a crafted entry in the redirection table of an I/O APIC.
RECOMMENDATIONS:
1.  Validate the return value of kvm_irq_delivery_to_apic to ensure it is not negative before assigning it to ioapic->rtc_status.pending_eoi.
2.  Add a check to ensure that ioapic->rtc_status.pending_eoi is not negative before using it in the rtc_status_pending_eoi_check_valid function. 

VULNERABILITY LIST:
CVE_ID:CVE-2014-0155
CVE Description:
The ioapic_deliver function in virt/kvm/ioapic.c in the Linux kernel through 3.14.1 does not properly validate the kvm_irq_delivery_to_apic return value, which allows guest OS users to cause a denial of service (host OS crash) via a crafted entry in the redirection table of an I