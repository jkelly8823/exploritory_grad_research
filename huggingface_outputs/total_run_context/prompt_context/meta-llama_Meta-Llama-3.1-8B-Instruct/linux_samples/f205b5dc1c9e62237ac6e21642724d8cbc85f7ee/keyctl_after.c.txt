 

VULNERABLE: YES
VULNERABLE_LINES: 1-5
EXPLANATION:
The code is vulnerable to CVE-2016-9604. The function keyctl_join_session_keyring() allows root to gain direct access to an internal keyring by joining it as its session keyring. This allows root to bypass module signature verification by adding a new public key of its own devising to the keyring.
RECOMMENDATIONS:
1.  The code should be modified to prevent root from joining internal keyrings. This can be achieved by adding a check to ensure that the keyring name does not start with a dot.
2.  The code should be modified to prevent root from adding new public keys to the keyring. This can be achieved by adding a check to ensure that the keyring is not the session keyring.
3.  The code should be modified to prevent root from bypassing module signature verification. This can be achieved by adding a check to ensure that the keyring is not the session keyring before adding a new public key.

VULNERABLE: NO
VULNERABLE_LINES: None
EXPLANATION:
The code is not vulnerable to CVE-2017-6951. The key