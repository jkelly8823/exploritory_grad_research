 

VULNERABLE: YES
VULNERABLE_LINES: 7-8
EXPLANATION:
The code is vulnerable to a hostname verification issue due to the silent omission of hostname verification when the server_hostname is empty. This is because the X509_VERIFY_PARAM_set1_host function is called with a zero name length, which is not supported by the int_x509_param_set_hosts function in LibreSSL 2.7.0 before 2.7.1. This allows man-in-the-middle attackers to spoof servers and obtain sensitive information via a crafted certificate.
RECOMMENDATIONS:
1. Check if the server_hostname is not empty before calling X509_VERIFY_PARAM_set1_host.
2. Use a secure method to verify the hostname, such as using a trusted certificate authority or implementing a custom hostname verification function. 
3. Upgrade to LibreSSL 2.7.1 or later to fix the issue. 

VULNERABILITY LIST:
CVE_ID:CVE-2018-8970
CVE Description:
The int_x509_param_set_hosts function in lib/libcrypto/x509/x509_vpm.c in LibreSSL 2.7.0 before 2.7.1 does not support a certain special case of a zero name length,