
VULNERABLE: YES
VULNERABLE_LINES: 11-13
EXPLANATION:
The code snippet checks if hardware transactional memory is active and then attempts to restore the user context. However, it does not check the integrity of the user context, which could potentially allow a local user to craft a malicious signal frame to cause a denial of service by triggering a TM Bad Thing exception and system crash. To