
VULNERABLE: YES
VULNERABLE_LINES: 1-3
EXPLANATION: The code checks if the host of the URL matches the request host, but it does not check if the scheme is HTTPS. An attacker could craft a URL with a different scheme and redirect to an unintended location.
RECOMMENDATIONS: Use HTTPS scheme and validate the scheme as well as the host.