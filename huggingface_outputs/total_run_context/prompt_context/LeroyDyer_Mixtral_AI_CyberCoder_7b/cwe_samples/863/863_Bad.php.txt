
VULNERABLE: YES
VULNERABLE_LINES: 1-3, 6-8
EXPLANATION: The code checks the role of the user from the cookie, but if the cookie is not set, it sets the role to user. This is a security vulnerability as it allows an attacker to bypass the intended access restrictions. The code should check if the role is set and if not, redirect to the login page instead of setting