

VULNERABLE: YES
VULNERABLE_LINES: 10,11
EXPLANATION:
The code snippet you provided appears to be vulnerable to CVE-2018-16477. The vulnerability stems from the way the `content_type` and `disposition` parameters are handled when constructing the service URL. 

Specifically, lines 10 and 11 show the following:

```ruby
service.url key, expires