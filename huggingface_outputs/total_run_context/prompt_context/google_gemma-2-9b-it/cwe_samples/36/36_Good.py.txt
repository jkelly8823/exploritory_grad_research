

VULNERABLE: YES
VULNERABLE_LINES: 6
EXPLANATION:
The code is vulnerable to path traversal attacks. The `os.path.normpath()` function is used to normalize the path, but it does not prevent the construction of absolute paths. An attacker could provide a filename like "/abs/path/to/sensitive_file.txt" as input, which would resolve to a path outside the intended directory.

RECOMMENDATIONS:
- San