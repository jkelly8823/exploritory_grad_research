

VULNERABLE: YES
VULNERABLE_LINES: 10
EXPLANATION:
The code snippet uses `strncpy` which is vulnerable to buffer overflow.  `strncpy` does not guarantee null-termination if the source string is longer than the destination buffer. This can lead to a buffer overflow if `filename` is longer than `sizeof(buf)-1`.

RECOMMENDATIONS:
* Use `snprintf` instead of `strncpy`. `snprintf` takes the size of