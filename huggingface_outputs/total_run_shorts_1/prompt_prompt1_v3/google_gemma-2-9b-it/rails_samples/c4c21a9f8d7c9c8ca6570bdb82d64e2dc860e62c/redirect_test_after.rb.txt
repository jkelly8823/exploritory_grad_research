

VULNERABLE: YES
VULNERABILITY_DESCRIPTION:  Potential Cross-Site Scripting (XSS) vulnerability
EXPLANATION:
The `redirect_to_params` method constructs a redirect URL that includes user-supplied data (`f: "%0Aeval(name)"`) within the `protocol` parameter. This could allow an attacker to inject malicious JavaScript code into the redirect URL, potentially leading to XSS attacks.

RECOMMENDATIONS:
- Sanitize user input