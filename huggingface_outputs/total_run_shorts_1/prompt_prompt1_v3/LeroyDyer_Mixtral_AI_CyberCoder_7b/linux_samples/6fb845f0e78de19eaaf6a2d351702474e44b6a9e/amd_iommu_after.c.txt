

VULNERABLE: YES
VULNERABILITY_DESCRIPTION: The function do_detach() is vulnerable to use-after-free race condition. The variable dev_data->domain is assigned to NULL after the call to domain_flush_complete() which can be accessed after the call to free_iova_fast() which can lead to a use-after-free vulnerability.
EXPLANATION: The function do_detach() updates the