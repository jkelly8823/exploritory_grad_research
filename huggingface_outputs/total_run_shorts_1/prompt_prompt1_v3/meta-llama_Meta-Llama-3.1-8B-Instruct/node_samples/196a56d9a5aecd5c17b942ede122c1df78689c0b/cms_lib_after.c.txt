 

VULNERABLE: YES
VULNERABLE_LINES: 5
VULNERABILITY_DESCRIPTION: A potential buffer overflow vulnerability exists in the function i2d_CMS_ContentInfo. The function does not properly validate the length of the CMS_ContentInfo structure before copying it to the output buffer.
EXPLANATION: The function i2d_CMS_ContentInfo takes a CMS_ContentInfo pointer as input and returns a pointer to the encoded CMS_ContentInfo structure. However, it does not check the length of the CMS_ContentInfo structure before copying it to the output buffer. This can lead to a buffer overflow if the CMS_ContentInfo structure is larger than the allocated buffer.
RECOMMENDATIONS: To fix this vulnerability, the function i2d_CMS_ContentInfo should be modified to check the length of the CMS_ContentInfo structure before copying it to the output buffer. This can be done by calling the CMS_ContentInfo_length function to get the length of the CMS_ContentInfo structure and then checking if the allocated buffer is large enough to hold the structure. If the buffer is too small, the function should return an error. Additionally, the function should be modified to use a safer function for copying the CMS_ContentInfo structure, such as memcpy_s, to prevent buffer