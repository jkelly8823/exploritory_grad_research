 

VULNERABLE: YES
VULNERABLE_LINES: 1
VULNERABILITY_DESCRIPTION: A buffer overflow vulnerability exists in the mt7915_mcu_add_group function. The function does not properly validate the length of the ie array, allowing an attacker to potentially overflow the buffer and execute arbitrary code.
EXPLANATION: The mt7915_mcu_add_group function does not check the length of the ie array before accessing it. This allows an attacker to potentially overflow the buffer and execute arbitrary code. The function should be modified to properly validate the length of the ie array before accessing it.
RECOMMENDATIONS: The mt7915_mcu_add_group function should be modified to check the length of the ie array before accessing it. This can be done by adding a check to ensure that the length of the ie array is greater than or equal to the expected length of the VHT capability information element. Additionally, the function should be modified to handle the case where the length of the ie array is less than the expected length. This can be done by returning an error code in this case. The modified function should look something like this: if (ie && ie[1] >= sizeof(*ht) && ie[1] <= len) {...