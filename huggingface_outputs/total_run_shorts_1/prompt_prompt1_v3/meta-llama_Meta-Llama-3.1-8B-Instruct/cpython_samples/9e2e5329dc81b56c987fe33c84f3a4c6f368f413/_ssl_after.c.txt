 

VULNERABLE: YES
VULNERABLE_LINES: 6
VULNERABILITY_DESCRIPTION: The code is vulnerable to a SSLv2 and SSLv3 protocol downgrade attack due to the use of SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS. This option is deprecated and can be exploited to downgrade the protocol to SSLv2 or SSLv3.
EXPLANATION: The SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS option is deprecated and can be exploited to downgrade the protocol to SSLv2 or SSLv3. This is because an attacker can send a specially crafted packet that will cause the server to insert an empty fragment, which can then be used to downgrade the protocol. This is a known vulnerability and should be avoided.
RECOMMENDATIONS: Remove the SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS option from the SSL_CTX_set_options call. Instead, use the SSL_OP_NO_SSLv2 and SSL_OP_NO_SSLv3 options to explicitly disable SSLv2 and SSLv3. This will prevent the protocol downgrade attack. Additionally, consider using a more secure protocol version, such as TLS 1.2 or later.  Also, consider using a secure session ID context, such as a random value generated using a cryptographically secure pseud